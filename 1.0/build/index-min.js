/*! ringNavi - v1.0 - 2013-08-24 6:17:47 PM
* Copyright (c) 2013 Letao; Licensed  */
KISSY.add("gallery/ringNavi/1.0/index",function(a,b,c){function d(b){var c=this;return this instanceof d?(c.trigger=a.one(b.trigger),c.items=c.trigger.all(b.items?b.items:".navitem"),c.displayArea=b.displayArea||{from:180,to:270},c.expandWay=b.expandWay,c.expanded=b.expanded,c.easing=b.easing||"easeIn",c.toggle=b.toggle,c.radius=b.radius||200,c.speed=b.speed||.2,c.delay=b.delay||150,c.exStatus=!1,c.timer=[],c.init(),d.superclass.constructor.call(c,b),void 0):new d(b)}b.all;var e=Math.PI,f=e/180;return a.extend(d,c,{init:function(){var a=this;a.expanded?a._setExpand():a._setFold(),a._bindEvent()},_setExpand:function(){var b=this,c=b.items.length,d=(b.displayArea.to-b.displayArea.from)/(c-1),e=0;"stepByStep"===b.expandWay&&(e=b.delay),b.exStatus=!0,b.items.each(function(c,g){c.css("display","block"),c.rs&&c.rs.isRunning()&&c.rs.stop(),b.timer[g]&&clearTimeout(b.timer[g]);var h=b.radius*Math.cos((b.displayArea.from+g*d)*f);h=h>0?Math.floor(h):Math.ceil(h);var i=-b.radius*Math.sin((b.displayArea.from+g*d)*f);i=i>0?Math.floor(i):Math.ceil(i),c.rs=new a.Anim(c,{opacity:1,left:h,top:i},b.speed,b.easing,function(){}),b.timer[g]=setTimeout(function(){c.rs.run()},g*e)})},_setFold:function(){var b=this;b.exStatus=!1,b.items.each(function(c,d){c.rs&&c.rs.isRunning()&&c.rs.stop(),b.timer[d]&&clearTimeout(b.timer[d]),c.rs=new a.Anim(c,{opacity:0,left:0,top:0},b.speed,b.easing,function(){c.css("display","none")}),c.rs.run()})},_bindEvent:function(){var a=this;a.trigger.on("click",function(b){a.toggle?a.exStatus?a._setFold():a._setExpand():a._setExpand(),b.preventDefault()})}},{ATTRS:{}}),d},{requires:["node","base"]});